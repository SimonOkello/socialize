{% extends 'includes/base.html' %}
{% load static %}
{% block title %}Home{% endblock title %}
{% block content %}
<section class="section">
    <div class="container">
        <div class="columns">
            {% include 'includes/_friends.html' %}
            <div class="column is-6" style="height: 100vh;overflow: scroll;">
                <div class="container">
                    <div class="card">
                        <form action="" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="card-content">
                                <div class="content">
                                    {{post_form.content}}
                                </div>
                            </div>
                            <footer class="card-footer">
                                <div class="file is-small">
                                    <label class="file-label">
                                        <input class="file-input" type="file" name="image">
                                        <span class="file-cta">
                                            <span class="file-icon">
                                                <i class="fas fa-upload"></i>
                                            </span>
                                            <span class="file-label">
                                                Photo…
                                            </span>
                                        </span>
                                    </label>
                                </div>
                                <button type="submit" name="post_btn" class=" button is-primary card-footer-item">Post</button>
                            </footer>
                        </form>
                    </div>
                    {% for post in posts %}
                    <div class="card mt-5">
                        <div class="header">
                            <div class="media">
                                <div class="media-left">
                                    <figure class="image is-32x32">
                                        <img src="{{post.author.avatar.url}}" class="is-rounded"
                                            alt="Placeholder image">
                                    </figure>
                                </div>
                                <div class="media-content">
                                    <p class="title is-5">{{post.author.full_name}}</p>
                                    <p class="subtitle is-6">{{post.created}}</p>

                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="content">
                                {{post.content}}
                                <br>
                            </div>
                        </div>
                        {% if post.image %}
                        <div class="card-image">
                            <figure class="image is-4by3">
                                <img src="{{post.image.url}}" alt="Placeholder image">
                            </figure>
                        </div>
                        {% endif %}
                        <div class="card-content">
                            <div class="content">
                                <nav class="level is-mobile">
                                    <div class="level-left">
                                        <p class="level-item">
                                            <span class="icon small"><i
                                                    class="material-icons">thumb_up</i>{{post.get_number_of_likes}}</span>
                                        </p>
                                    </div>
                                    <div class="level-right">
                                        <p class="level-item">
                                            <span class="icon small"><i
                                                    class="material-icons">comment</i>{{post.get_number_of_comments}}</span>
                                        </p>
                                    </div>

                                </nav>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="card-footer-item">
                                <form action="{% url 'posts:like-post-view' %}" method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="post_id" , value="{{post.id}}">
                                    <button type="submit" class=" button is-white">
                                        {% if obj not in post.liked.all %}
                                        <i class="material-icons">thumb_up</i> Like
                                        {% else %}
                                        <i class="material-icons">thumb_down</i> Unlike
                                        {% endif %}
                                    </button>
                                </form>
                            </div>
                            <a href="#" class="card-footer-item">Comment</a>
                        </div>
                        <br>
                        <!-- COMMENT SECTION -->
                        {% for comment in post.comment_set.all %}
                        <article class="media">
                            <figure class="media-left">
                              <p class="image is-24x24">
                                <img src="{{comment.user.avatar.url}}" class="is-rounded">
                              </p>
                            </figure>
                            <div class="media-content">
                              <div class="content">
                                <p>
                                  <span class="title is-6"><strong>{{comment.user.full_name}}</strong></span>
                                  <br>
                                  {{comment.body}}
                                  <br>
                                  <small><a>Like</a> · <a>Reply</a> · {{comment.created|timesince}} ago</small>
                                </p>
                              </div>
                              <!-- REPLY SECTION -->
                              <!-- <article class="media">
                                <figure class="media-left">
                                  <p class="image is-48x48">
                                    <img src="https://bulma.io/images/placeholders/96x96.png">
                                  </p>
                                </figure>
                                <div class="media-content">
                                  <div class="content">
                                    <p>
                                      <strong>Sean Brown</strong>
                                      <br>
                                      Donec sollicitudin urna eget eros malesuada sagittis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam blandit nisl a nulla sagittis, a lobortis leo feugiat.
                                      <br>
                                      <small><a>Like</a> · <a>Reply</a> · 2 hrs</small>
                                    </p>
                                  </div>

                                  <article class="media">
                                    Vivamus quis semper metus, non tincidunt dolor. Vivamus in mi eu lorem cursus ullamcorper sit amet nec massa.
                                  </article>

                                  <article class="media">
                                    Morbi vitae diam et purus tincidunt porttitor vel vitae augue. Praesent malesuada metus sed pharetra euismod. Cras tellus odio, tincidunt iaculis diam non, porta aliquet tortor.
                                  </article>
                                </div>
                              </article> -->
                            </div>
                          </article>
                          {% endfor %}

                          <article class="media">
                            <figure class="media-left">
                              <p class="image is-24x24">
                                <img src="{{obj.avatar.url}}" class="is-rounded">
                              </p>
                            </figure>
                            <div class="media-content">
                                <form action="" method="POST">
                                    {% csrf_token %}
                              <div class="field">
                                <p class="control">
                                    {{comment_form.body}}
                                </p>
                              </div>
                              <div class="field">
                                <p class="control">
                                    <input type="hidden" name="post_id" , value="{{post.id}}">
                                    <button type="submit" name="comment_btn" class="button mx-2 my-2 is-info is-small">Comment</button>
                                </p>
                              </div>
                                </form>
                            </div>
                          </article>
                    </div>
                    {% endfor %}

                </div>
            </div>
            {% include 'includes/_groups.html' %}
        </div>
    </div>
</section>

{% endblock %}